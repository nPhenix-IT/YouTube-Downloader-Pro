üì± Guide : Compiler son APK Android via GitHub Actions (Cloud)

Ce guide t'explique comment transformer ton fichier Python (main_android.py) en une application Android (.apk) installable, en utilisant les serveurs de GitHub.

üìÇ √âtape 1 : Pr√©paration des fichiers locaux

Avant d'envoyer quoi que ce soit sur GitHub, ton dossier de projet sur ton ordinateur doit √™tre propre et contenir ces 3 √©l√©ments essentiels.

1. Ton code source

Assure-toi que ton fichier s'appelle bien main_android.py (celui que j'ai cr√©√© pour toi pr√©c√©demment).

2. Le fichier des d√©pendances (requirements.txt)

Cr√©e un fichier texte nomm√© exactement requirements.txt √† c√¥t√© de ton script. Il indique au serveur quels modules installer.
Contenu du fichier :

flet
yt-dlp


(Note : On ne met pas imageio-ffmpeg car la version Android n'utilise pas les binaires FFmpeg).

3. (Optionnel) Une ic√¥ne

Si tu as une image icon.png, mets-la dans le dossier. Sinon, l'app aura l'ic√¥ne Flet par d√©faut.

‚òÅÔ∏è √âtape 2 : Cr√©ation du Repository GitHub

Connecte-toi sur GitHub.com.

Clique sur le bouton + en haut √† droite > New repository.

Donne un nom (ex: youtube-downloader-app).

Laisse en Public (c'est gratuit et plus simple pour commencer).

Clique sur Create repository.

üöÄ √âtape 3 : Mettre ton code sur GitHub

Tu as deux options pour envoyer tes fichiers :

Option Facile (Web) :

Dans ton nouveau repository GitHub, clique sur "uploading an existing file".

Glisse tes fichiers (main_android.py et requirements.txt) dans la zone.

Clique sur "Commit changes".

Option Pro (Git) : Si tu as Git install√©, fais les commandes habituelles (git init, git add ., git commit, git push).

‚öôÔ∏è √âtape 4 : Cr√©er le Workflow (Le Cerveau)

C'est ici que la magie op√®re. Nous allons donner les instructions au robot de GitHub.

Dans ton repository sur GitHub, clique sur l'onglet Actions (en haut).

Clique sur set up a workflow yourself (lien bleu souvent discret).

Nomme le fichier : main.yml (ou android_build.yml).

Copie et colle exactement le code ci-dessous dans l'√©diteur :

name: Build Android APK

on:
  push:
    branches: [ "main", "master" ]
  workflow_dispatch: # Permet de lancer manuellement avec un bouton

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # 1. R√©cup√©rer le code
    - name: Checkout code
      uses: actions/checkout@v3

    # 2. Installer Python
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    # 3. Installer Java (N√©cessaire pour Android)
    - name: Setup Java
      uses: actions/setup-java@v3
      with:
        distribution: 'temurin'
        java-version: '17'

    # 4. Installer Flutter (Moteur de Flet Mobile)
    - name: Setup Flutter
      uses: subosito/flutter-action@v2
      with:
        flutter-version: '3.19.0' # Version stable recommand√©e

    # 5. Installer les d√©pendances Python
    - name: Install Dependencies
      run: |
        pip install -r requirements.txt
        pip install flet # On s'assure que Flet est l√† pour la commande build

    # 6. Compiler l'APK
    # CORRECTION : Suppression de --product-name et --org qui causaient l'erreur
    # On garde uniquement --project et --verbose
    - name: Build APK with Flet
      run: |
        flet build apk --project main_android.py --verbose

    # 7. Sauvegarder l'APK pour que tu puisses le t√©l√©charger
    - name: Upload APK Artifact
      uses: actions/upload-artifact@v4
      with:
        name: youtube-downloader-apk
        path: build/apk/app-release.apk
